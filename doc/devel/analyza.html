<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
<title>Analýza projektu</title>
</head>
<body bgcolor="#FFFFFF">
<h1 align="center"> Analýza projektu </h1>
<h2>1. ©pecifikácia cieµov</h2>
<ul>
<li> <b>databáza údajov</b> - v¹etky údaje získané pri meraní jaskýò a ich
	dokumentácii prehµadne ulo¾ené vo vstupných súboroch. Takisto mo¾nos»
	pou¾i» ako vstupné dáta akékoµvek údaje v poèítaèi (databázu,
	databázový súbor, súbory s obrázkami).
<li> <b>prezenácia údajov</b> - mo¾nos» exportova» zadané údaje v upravenej forme (HTML, TeX, PDF, TXT)
<li> <b>dvojrozmerné mapy</b> - pôdorys, bokorys, rozvinutý rez. K mapovým
	objektom existujú linky a odkazy, tak¾e pomocou prezeraèa sa dá dosta»
	aj k ostatným údajom, týkajúcich sa daných objektov.
<li> <b>trojrozmerný model</b> - trojrozmerný model chodieb jaskyne. Model takisto obsahuje aj iné objekty okrem chodieb. Tie sú takisto prelinkované s údajmi o nich a pomocou prezeraèa je mo¾nos» ich zobrazi».
<li> <b>export</b> - výstup dát (mapy, trojrozmerný model, údaje o objektoch) do iných enginov. Jedná sa hlavne o vytvorenie relaènej databázy v SQL formáte, ïalej o export dát do VTK pre ïal¹iu analýzu ako aj export údajov do formátov pou¾ívaných v ne¹tandardných programoch (M$ Office).
</ul>
<h2>2. Hrubá ¹truktúra objektov</h2>
<p>Základnou ¹truktúrnou jednotkou v dátach je SURVEY (Meranie). Tieto tvoria stromovú ¹truktúru na ktorú sa via¾u v¹etky dáta. Ka¾dý dátový objekt musí patri» do nejakého merania a v danom meraní má jedineèný názov medzi objektami svojej triedy.</p>
<p>V ka¾dom meraní sa objekty dajú roztriedi» viac menej do nasledovných skupín:</p><ul>
<li><b>dátové objekty</b> - objekty bez priestorovej reprezentácie (polygon, photo, entrance_data). Obsahujú údaje, ktpré sú prilinkované k iným objektom. 
<li><b>v¹eobecné objekty</b> - objekty ktoré majú svoju presnú polohu v priestore a takisto aj priestorovú reprezentáciu (entrance, vzrka, klimatické pozorovanie, vrt).
Tieto objekty sú automaticky vkladané do 2d aj 3d máp. Obyèajne majú k sebe prilinkované dátové objekty, ktoré ich presnej¹ie popisujú.
<p>Ich ¹pecifickou súèas»ou sú <b>chodby</b> (passage), ktoré sú zadávané v samostatnej sekcii a rekon¹truované z rezov.
<li><b>mapové bloky</b> - sú to ucelené èasti chodieb, koré sa skladajú z <b>mapových objektov</b>.
Tieto objekty majú takisto svoju reprezentáciu aj v 3d priestore, ale do priestorových máp nie sú automaticky vkladané. Niektoré z nich tvoria len akoby 2d reprezentáciu v¹eobecných 3d objektov a sú k nim priamo prilinkované.
(Napr symbol klimatického pozorovania ktorý je kvôli prehladnosti mimo chodby, hoci objekt tohto pozorovania sa nachádza priamo v chodbe.)
<li><b>rezy</b> - tvoria prechod medzi 2d a 3d. Sú to takisto mapové bloky, ale zadané sú v lokálnych súradniciach. Mo¾no ich vlo¾i» do 2d mapy, alebo z nich rekon¹truova» 3d povrch chodby. 
</ul>
<p> Ka¾dému z objektov, ktorý má svoju priestorovú reprezentáciu sú e¹te priradené vrstvy, v ktorých le¾í. <b>Vrstva</b> (layer) nie je skutoèný objekt. Je to len abstraktná kon¹trukcia, ktorá pomáha pri tvorbe výslednej mapy alebo modelu vyselektova» objekty, ktoré pôjdu do zobrazenia. Základným nástrojom selekcie sú v¹ak merania a bloky.
</p>
<h2>3. ©truktúra vstupných dát</h2>
<p> Hlavným zdrojom vstupných údajov (aspoò pre jaskyne) je textový súbor. Pri pou¾ití iných zdrojov, ako sú napr. databáza alebo iné programy prebieha vkladanie dát cez textový stream, ktorý má úplne rovnakú syntax.
<p> Príkazy textového súboru majú ¹tandardnú syntax. Najprv ide názov príkazu, za ním povinný poèet parametrov a potom jednotlivé prepínaèe.
Znakmi '#' sú v súboroch vyznaèené komentáre.
Pomocou príkazu <b>include</b> sa na dané miesto v súbore vlo¾í iný súbor, èo umo¾òuje ma» aj pomerne rozsiahle dáta ulo¾ené prehµadne vo viacerých súboroch v danej adresárovej ¹truktúre. Samostatným príkazom je <b>encoding</b>, ktorého parametrom je kódová stránka, v ktorej je daný súbor napísaný. 
V¹etky ostatné riadny sú pova¾ované za príkazy. Ak v danom kontexte je daný príkaz neznámy, riadok sa pova¾uje za dátový riadok. (Takisto ak riadok zaèína znakom '\'.)
<p> Základnou ¹truktúrnou jednotkou aj v súboroch je <b>survey</b>. Ka¾dé sa zaèína príkazom <tt>survey</tt> a konèí príkazom <tt>endsurvey</tt>. Tieto mô¾u by» do seba vnorené.
V ka¾dom meraní sa potom u¾ definujú jednotlivé objekty. V závislosti od objektu sú definované samostatne (polygon, passage) alebo v nejakom kontexte (map).
<h2>4. ©truktúra spracovania</h2>
<p> Na spracovanie údajov budú slú¾i» skripty a programy napísané pou¾itím dvoch základných kni¾níc. Jednej Perlovskej, urèenej na spracovanie vstupných textov a druhej npísanej v C++ a urèenej na konkrétne spracovanie objektov. Postup spracovania by sa dal zhrnú» v nasledovných bodoch:
</p>
<ol>
<li> vstup: textové súbory, databáza, iné programy, iné súbory
<li> èítací skript (Perl): jeden upravený textový súbor
<li> skript na naèítanie objektov (Perl): predkompilovaný súbor
<li> vyrovnávací skript (Perl) - naèítanie polygónu, vyrovnanie (nepovinné),
     vlo¾enie súradníc meraèských bodov do predkompilovaného súboru:
     upravený predkompilovaný súbor
<li> spracovávací program (C++): binárny súbor obsahujúci v¹etky údaje
<li> exporter (C++): export do výstupných súborov (HTML, TeX, VTK)
<li> roz¹írené spracovanie (C++, Perl, Tcl, ...)
</ol>
<h2>5. Spracovávacie moduly</h2>
<ol>
<li><b>Modul na spracovanie textového súboru</b>
    <ul>
    <li> odstránenie komentárov
    <li> povkladanie súborov
    <li> zlúèenie dlhých riadkov
    <li> vytvorenie jedného vstupného súboru
    <li> vytvorenie paralelného súboru so zdrojovýmy atribútmi (typ zdroja, adresár, zdrojový súbor, kódovanie národných znakov ...)
    </ul>
<li><b>Moduly na spracovanie objektov</b>
    <ul>
    <li> vytvorenie kontextu meraní (hash survey - id)
    <li> kontextové spracovanie príkazov a vytvorenie objektov
    <li> transformaèné funkcie
    <li> kontrola syntaxe parametrov prepínaèov
    </ul>
<li><b>Vyrovnávací modul</b>
    <ul>
    <li> naèítanie polygónu
    <li> export pre vyrovnávací program
    <li> naèítanie vyrovnaných súradníc
    <li> pripísanie do predkompilovaného súboru
    </ul>
</ol>
<h2>6. Objektová kni¾nica </h2>
<p>Táto bude budovaná podµa vzoru VTK. Základné triedy budú ma» zhruba rovnaké
   vlastnosti a takisto aj práca s nimi bude podobná. Základné triedy sú
   nasledovné:
<ul> 
<li> <b>thDataObject</b> - trieda ktorej potomkovia budú dátovými triedami. Obsahuje objekty bez priestorovej reprezentácie aj s òou. Objekty s priestorovou reprezentáciou budú potomkami tried <b>thPoint, thPolyLine, thPolygon, thMesh</b>.
Objekty bez nej budú napr. <b>thSurvey, thMapBlock, thPhoto, thEntranceData</b>.
<li> <b>thDataSet</b> - trieda ktorej potomkovia budú zdru¾ova» dátové objekty do ¹truktúr, ktoré sa u¾ budú konkrétnym spôsobom spracováva».
Momentálne sa predpokladá iba jeden potomok, a to <b>thCaveSurveyData</b>.
Je ale pravdepodobné, ¾e pri ïal¹om spracovaní bude treba vytvori» aj iné triedy tohto typu, slú¾iace napríklad na nastavenie viditeµností, farieb alebo spôsbov reprezentácie.
<li> <b>thProcessObject</b> - trieda zdru¾ujúca v¹etky objekty a filtre ktoré prevádzajú konkrétne spracovanie alebo io operácie nad dátami.
</ul>
<h2>7. Dátové objekty</h2>
<p>Základnou vlastnos»ou v¹etkých dátových objektov je ich vzájomná
previazanos». Ku tomu sú prispôsobené aj vlastnosti a metódy ich tried.
Na identifikáciu konkrétneho objektu by mali slú¾i» tieto jeho vlastnosti:
<ol>
<li><b>typ objektu</b> - id triedy tohto objektu, takisto aj id v¹etkých tried,
ktorých je potomkom, aby sa na jeho prípadné spracovanie mohli pou¾i»
algoritmy, ktoré vedia pracova» len z ni¹¹ími triedami.
<li><b>id objektu</b> - konkrétne a jedineèné id objektu medzi v¹etkými
objektami (resp. objektami danej triedy ?). Toto je potrebné pri ukladaní a naèítavaní súborov, keby pointerové odkazy musia by» transformované na èíselné a opaène.
<li><b>meno objektu</b> - nepovinné, ale u¾itoèné zada» hlavne pri dôle¾itých objektoch.
Výber objektov sa toti¾ bude robi» práve pomocou tohto mena a takisto aj
linkovanie navzájom sa bude zadáva» menovým odkazom. Toto meno musí by» jedineèné medzi objektami danej triedy a v danom meraní. Odkazovanie potom funguje nasledovne: meno_triedy:meno_objektu[@meno_merania[.meno_merania[...]]].
<li><b>zoznam vrstiev</b> - nepovinné, ale takisto u¾itoèné. Uµahèuje to výber objektov pre výstup.
</ol>
<p> Vlastnos»ou objektu bude aj zoznam odkazov na prilinkované obkjekty. Prilinkova» k objektu mo¾no akýkoµvek iný objekt.
Pomocou ¹peciálnych objektov ako sú napr. <b>thExtURL</b>, <b>thExtFile</b>,
<b>thExtDBRecord</b> mo¾no k objektom prilinkova» aj konkrétnu URL, externý súbor alebo záznam v databáze.
<p> Okrem tohto voµného linkovania mô¾u existova» aj iné stupne náväznosti na iné objekty.
Napr. konkrétne klimatické pozorovanie ako priestorový objekt reprezentovaný
bodom obsahuje v sebe zoznam dát z týchto pozorovaní. (Na jednom mieste sa robili pozorovania vo viacerých èasoch).
Tieto ale nie sú obsiahnuté v zozname prilinkovaných objektov, ale
v samostatnom zozname, lebo to vy¾aduje ich spracovanie. Práve kvôli takýmto prípadom obsahujú metódy na získanie údajov o linkovaných objektoch aj parameter
<b>link_level</b>, ktorý hovorí o stupni náveznosti linkov ktoré berieme
do úvahy pri týchto metódach. Obsluha voµných linkov je rie¹ená v triede
<b>thDataObject</b>, metódy v jej potomkoch sú potom príslu¹ným spôsobom
predefinované, aby vracali aj iné ako voµne prilinkované objekty.
</body>
</html>
